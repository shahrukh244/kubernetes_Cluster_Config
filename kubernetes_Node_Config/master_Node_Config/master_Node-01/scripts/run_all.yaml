---
- name: Prepare root SSH access to 10.0.0.111
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Test SSH connectivity as root (non-fatal)
      ansible.builtin.command: ssh -o BatchMode=yes -o ConnectTimeout=10 root@kube-cp-1.kube.lan 'echo OK'
      ignore_errors: yes
      register: ssh_test
      changed_when: false

    - name: Run canLoginAsRoot.py if SSH failed
      ansible.builtin.command: python3 "{{ lookup('env', 'HOME') }}/kubernetes_Cluster_Config/kubernetes_Node_Config/master_Node_Config/master_Node-01/scripts/canLoginAsRoot.py"
      when: ssh_test.failed
      changed_when: true
